# Bridge Line プロジェクト構造図

## プロジェクト全体構造

| カテゴリ | ディレクトリ/ファイル | 説明 |
|:---------|:---------------------|:-----|
| **Docker環境** | docker-compose.yml | 全サービスのオーケストレーション |
| | backend/Dockerfile | バックエンドコンテナの定義 |
| | scripts/init_db.sql | データベース初期化スクリプト |
| **開発環境** | Makefile | 統一された開発コマンド |
| | scripts/ | OS別セットアップスクリプト |
| | .gitignore | Git除外設定 |
| **ドキュメント** | docs/ | プロジェクトドキュメント |
| | README.md | プロジェクト概要 |
| | .github/ | GitHub設定 |
| **バックエンド** | backend/ | FastAPI バックエンド |
| | backend/app/ | アプリケーション本体 |
| | backend/app/api/ | API エンドポイント |
| | backend/app/core/ | コア設定・データベース |
| | backend/app/models/ | データベースモデル |
| | backend/app/schemas/ | Pydantic スキーマ |
| | backend/app/services/ | ビジネスロジック |
| | backend/app/utils/ | ユーティリティ |
| | backend/alembic/ | データベースマイグレーション |
| | backend/tests/ | テストコード |
| | backend/requirements.txt | Python依存関係 |
| | backend/.env.example | 環境変数テンプレート |
| **フロントエンド** | frontend/ | Next.js フロントエンド |
| | frontend/src/ | ソースコード |
| | frontend/src/app/ | Next.js App Router |
| | frontend/src/components/ | React コンポーネント |
| | frontend/src/hooks/ | カスタムフック |
| | frontend/src/lib/ | ライブラリ・ユーティリティ |
| | frontend/src/store/ | 状態管理 |
| | frontend/src/types/ | TypeScript型定義 |
| | frontend/public/ | 静的ファイル |
| | frontend/package.json | Node.js依存関係 |
| **共通・共有** | shared/ | フロントエンド・バックエンド共通 |
| | shared/constants/ | 共通定数 |
| | shared/types/ | 共通型定義 |
| | shared/utils/ | 共通ユーティリティ |
| **インフラ・監視** | infra/ | 本番環境設定 |
| | infra/docker/ | Docker設定 |
| | infra/k8s/ | Kubernetes設定 |
| | infra/terraform/ | Terraform設定 |
| | infra/scripts/ | インフラスクリプト |
| | monitoring/ | 監視・ログ設定 |
| | monitoring/grafana/ | Grafanaダッシュボード |
| | monitoring/prometheus/ | Prometheus設定 |
| | monitoring/alerts/ | アラート設定 |

## データフロー関係図

```mermaid
graph TB
    subgraph "開発者"
        A[開発者]
    end
    
    subgraph "開発環境"
        B[Makefile]
        C[scripts/]
        D[docker-compose.yml]
    end
    
    subgraph "バックエンド"
        E[backend/app/]
        F[backend/models/]
        G[backend/schemas/]
        H[backend/alembic/]
    end
    
    subgraph "フロントエンド"
        I[frontend/src/]
        J[frontend/components/]
        K[frontend/hooks/]
    end
    
    subgraph "データベース"
        L[PostgreSQL]
        M[Redis]
    end
    
    subgraph "共通・共有"
        N[shared/]
        O[docs/]
    end
    
    A --> B
    B --> C
    C --> D
    D --> E
    D --> L
    D --> M
    
    E --> F
    E --> G
    E --> H
    H --> L
    
    A --> I
    I --> J
    I --> K
    
    N --> E
    N --> I
    O --> A
```

## チーム開発での責任分離

```mermaid
graph LR
    subgraph "バックエンド開発者"
        A[backend/]
        B[backend/app/]
        C[backend/models/]
        D[backend/schemas/]
    end
    
    subgraph "フロントエンド開発者"
        E[frontend/]
        F[frontend/src/]
        G[frontend/components/]
        H[frontend/hooks/]
    end
    
    subgraph "インフラ担当者"
        I[infra/]
        J[monitoring/]
        K[docker-compose.yml]
    end
    
    subgraph "全員共通"
        L[shared/]
        M[docs/]
        N[scripts/]
    end
    
    A --> B
    B --> C
    B --> D
    
    E --> F
    F --> G
    F --> H
    
    I --> K
    J --> K
    
    L --> A
    L --> E
    M --> A
    M --> E
    N --> A
    N --> E
```

## セットアップフロー

```mermaid
graph TD
    A[開発者] --> B{OS判定}
    B -->|Mac| C[dev-setup-mac.sh]
    B -->|Windows| D[dev-setup.ps1]
    B -->|Linux| E[dev-setup.sh]
    
    C --> F[Docker環境起動]
    D --> F
    E --> F
    
    F --> G[PostgreSQL起動]
    F --> H[Redis起動]
    F --> I[Backend起動]
    
    I --> J[alembic upgrade]
    J --> K[データベース初期化]
    
    K --> L[開発環境準備完了]
```

## 主要ディレクトリの役割

| ディレクトリ | 役割 | 担当者 |
|:-------------|:-----|:-------|
| **backend/** | FastAPI バックエンド | バックエンド開発者 |
| **frontend/** | Next.js フロントエンド | フロントエンド開発者 |
| **shared/** | 共通コード・型定義 | 全員 |
| **scripts/** | 開発環境セットアップ | 全員 |
| **docs/** | プロジェクトドキュメント | 全員 |
| **infra/** | 本番環境設定 | インフラ担当者 |
| **monitoring/** | 監視・ログ設定 | インフラ担当者 |

## 明日の横展開で伝えるべきポイント

### 1. 統一されたセットアップ
```bash
# 全OS共通コマンド
make setup
```

### 2. 開発コマンド
```bash
make start      # 環境起動
make stop       # 環境停止
make logs       # ログ確認
make migrate    # マイグレーション
make test       # テスト実行
```

### 3. 責任分離のルール
- **バックエンド開発者**: `backend/` 配下のみ
- **フロントエンド開発者**: `frontend/` 配下のみ
- **共通コード**: `shared/` に配置
- **ドキュメント**: `docs/` に集約

### 4. 開発フロー
1. `make setup` で環境構築
2. 各担当ディレクトリで開発
3. `shared/` で共通コード管理
4. `docs/` でドキュメント更新

```text
新規参加者の場合
# 1. リポジトリのクローン
git clone <repository-url>
cd bridge-line

# 2. 環境構築（これだけで完了）
make setup

# 3. 開発開始
make logs backend    # バックエンド開発
cd frontend && npm run dev  # フロントエンド開発
```
```text
既存メンバーの場合
# 最新コードの取得
git pull origin main

# 環境の再起動
make restart

# マイグレーションの実行（必要に応じて）
make migrate
```


この構造により、チーム全員が効率的に開発を進めることができます。 