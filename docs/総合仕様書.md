## プロジェクト概要

Bridge LINEは、BtoB向けチームコミュニケーションアプリケーションです。チーム単位での音声チャット、リアルタイム文字起こし、AI分析による個人特性フィードバックを提供し、チーム責任者による一元的な管理・決済機能を備えています。

---

### アプリケーションの特徴

- **BtoB特化**: 企業・組織のチーム単位での導入を想定
- **音声コミュニケーション**: 音声のみでのチャット機能に特化
- **AI分析フィードバック**: 話者別の発言特性を分析し、個人の成長をサポート
- **チーム責任者管理**: 責任者による決済・メンバー管理の一元化

## 開発体制・制約

- **開発チーム**: 3人（全員初学者）
- **開発期間**: 70時間（5時間/日 × 14日）
- **技術習得**: 実装と並行して学習
- **開発ゴール**: 本番環境へのデプロイ完了
- **品質保証**: フロント/バック/E2Eテスト必須実施

## 技術スタック

### フロントエンド

- **フレームワーク**: Next.js 14.2.3 (App Router)
- **言語**: TypeScript 5.4.3
- **UIライブラリ**: Material-UI (MUI) v5.15.15 + Radix UI + Tailwind CSS
- **状態管理**: Zustand + React Hook Form
- **認証**: Firebase Authentication
- **決済**: Stripe v15.8.0
- **リアルタイム通信**: WebSocket (実装済み)
- **音声処理**: WebRTC + カスタム音声処理フック
- **フォーム**: React Hook Form + Zod バリデーション
- **データ可視化**: Recharts 3.1.2

### バックエンド

- **フレームワーク**: FastAPI 0.110.1
- **言語**: Python 3.11+
- **ORM**: SQLAlchemy 2.0.29
- **データベース**: PostgreSQL 15 + Alembic マイグレーション
- **認証**: Firebase Admin SDK 6.5.0
- **決済**: Stripe Python SDK 8.11.0
- **音声処理**: OpenAI Whisper API, librosa, numpy, scipy
- **AI分析**: OpenAI GPT-4o API 1.14.3
- **リアルタイム通信**: WebSocket (websockets 12.0)
- **ログ**: structlog 24.1.0
- **キャッシュ**: Redis 5.0.3

### インフラ・デプロイメント

- **コンテナ**: Docker + Docker Compose
- **クラウド**: Vercel (フロント) + Railway (バック + DB)
- **CI/CD**: GitHub Actions
- **監視**: 基本ログ + エラートラッキング
- **セキュリティ**: HTTPS, CORS, 環境変数管理

## ページ遷移・画面構成

```
Firebase認証ログイン
　↓
ダッシュボード
　├── 音声チャットルーム
　│   ├── ログイン中メンバー表示
　│   ├── 音声チャット機能
　│   └── リアルタイム文字起こし表示
　├── チームメンバー管理（責任者のみ）
　│   ├── メンバー一覧・招待
　│   ├── 各メンバーのプロフィール詳細
　│   └── メンバー権限管理
　├── マイプロフィール
　│   ├── プロフィール編集
　│   └── AI分析フィードバック一覧
  ├── AI分析ダッシュボード
  │   ├── 分析履歴一覧
  │   ├── 詳細分析レポート
  │   └── データ可視化（グラフ・チャート）
  ├── チームダイナミクス分析
  │   ├── チーム全体の分析
  │   └── メンバー間の関係性分析
  └── チーム管理（責任者のみ）
　　　├── 決済・プラン管理
　　　├── 使用量確認
　　　└── チーム設定

```

## コア機能

| 機能名 | 説明 | 対象ユーザー | 実装状況 |
| --- | --- | --- | --- |
| ユーザー認証 | Firebase Authentication + ロール管理 | 全ユーザー | ✅ 実装済み |
| 音声チャットルーム | WebRTC音声通話・リアルタイム文字起こし | 全ユーザー | ✅ 実装済み |
| AI分析・フィードバック | 発言特性分析・個人特性フィードバック | 全ユーザー | ✅ 実装済み |
| AI分析ダッシュボード | 分析結果の可視化・履歴管理 | 全ユーザー | ✅ 実装済み |
| チームダイナミクス分析 | チーム全体の分析・メンバー関係性 | 全ユーザー | ✅ 実装済み |
| チーム管理 | メンバー招待・権限管理 | 責任者のみ | ✅ 実装済み |
| 決済・プラン管理 | Stripeサブスクリプション決済 | 責任者のみ | ✅ 実装済み |
| プロフィール管理 | 個人情報・AI分析結果閲覧 | 全ユーザー | ✅ 実装済み |
| 管理者機能 | 管理者専用ダッシュボード・ユーザー管理 | 管理者のみ | ✅ 実装済み |
| 参加者管理 | 音声セッション参加者管理・権限制御 | セッション管理者 | ✅ 実装済み |
| 音声品質向上 | AI音声処理・ノイズ除去 | 全ユーザー | 🔄 部分実装 |
| WebSocket通信 | リアルタイムメッセージング・通知 | 全ユーザー | ✅ 実装済み |
| リアルタイム分析更新 | WebSocket経由での分析結果更新 | 全ユーザー | ✅ 実装済み |
| データ可視化 | Rechartsによるグラフ・チャート表示 | 全ユーザー | ✅ 実装済み |

## 実装済み機能詳細

### 認証・ユーザー管理
- Firebase Authentication連携
- JWTトークンによる認証
- ロールベースの権限管理（owner, admin, member）
- ユーザープロフィール管理

### AI分析システム
- **個性分析**: 性格特性の分析・スコアリング
- **コミュニケーション分析**: 発言パターン・効果性の分析
- **行動特性分析**: 行動パターン・傾向の分析
- **感情分析**: 発言内容の感情スコアリング
- **リアルタイム更新**: WebSocket経由での分析結果更新
- **データ可視化**: レーダーチャート、棒グラフ、円グラフ、線グラフ

### 音声チャット・文字起こし
- WebRTCによる音声通話
- OpenAI Whisper APIによる文字起こし
- リアルタイム文字起こし表示
- 音声セッション管理
- 参加者権限管理

### チーム管理
- チーム作成・設定
- メンバー招待・管理
- 権限レベル管理
- チーム設定・カスタマイズ

### 管理者機能
- 管理者専用ダッシュボード
- ユーザー管理・監視
- システム設定・管理
- 監査ログ・セキュリティ監査

### 決済・サブスクリプション
- Stripe API連携（v15.8.0）
- 3段階プラン管理（Basic/Premium/Enterprise）
- 動的プラン決定（ユーザー数に基づく自動判定）
- 年額プラン割引（20%割引）
- 決済履歴・請求管理
- 使用量監視・制限
- プラン料金ベースの決済システム

#### プラン詳細仕様
- **Basic Plan**: 月額980円、年額9,800円（20%割引、月額換算784円）、最大10名、50セッション/月
- **Premium Plan**: 月額2,980円、年額29,800円（20%割引、月額換算2,384円）、最大50名、200セッション/月
- **Enterprise Plan**: 月額9,800円、年額98,000円（20%割引、月額換算7,840円）、無制限利用

#### 動的プラン決定ロジック
- ユーザー数 ≤ 10名 → Basic Plan
- ユーザー数 ≤ 50名 → Premium Plan
- ユーザー数 > 50名 → Enterprise Plan

#### 決済フロー
1. ユーザー数に基づくプラン自動判定
2. Stripe Checkout Session作成
3. 決済完了後のWebhook処理
4. サブスクリプション状態更新

### リアルタイム通信
- WebSocket接続管理
- リアルタイムメッセージング
- 接続状態監視
- 自動再接続機能

## 開発・テスト状況

### 実装完了済み
- ✅ バックエンドAPI基盤（FastAPI + SQLAlchemy）
- ✅ データベース設計・マイグレーション
- ✅ 認証・認可システム
- ✅ ユーザー・チーム管理
- ✅ AI分析サービス
- ✅ WebSocket通信基盤
- ✅ フロントエンド基盤（Next.js + TypeScript）
- ✅ UIコンポーネント（MUI + Radix UI + Tailwind CSS）
- ✅ 認証・プロフィール管理
- ✅ AI分析ダッシュボード
- ✅ データ可視化（Recharts）
- ✅ リアルタイム更新機能

### 開発中・部分実装
- 🔄 音声処理・品質向上機能
- 🔄 通知システム
- 🔄 モバイル対応

### 実装完了（決済システム）
- ✅ Stripe決済システム統合
- ✅ 動的プラン決定ロジック
- ✅ プラン料金ベースの決済
- ✅ 年額プラン割引機能
- ✅ 決済テストスイート
- ✅ Webhook処理
- ✅ 管理者決済管理画面

### 今後の拡張予定
- 📋 高度なAI分析機能
- 📋 チームビルディングゲーム
- 📋 多言語対応
- 📋 モバイルアプリ
- 📋 高度なセキュリティ機能

## 品質保証・テスト

### テスト戦略
- **単体テスト**: バックエンド（Pytest）、フロントエンド（Jest）
- **統合テスト**: API エンドポイントテスト
- **E2Eテスト**: Cypressによるユーザーフローテスト
- **型チェック**: TypeScript、MyPyによる静的解析

### コード品質
- **Linting**: ESLint（フロント）、Flake8（バック）
- **Formatting**: Prettier（フロント）、Black（バック）
- **型チェック**: TypeScript、MyPy
- **セキュリティ**: 依存関係の脆弱性チェック

## デプロイメント・運用

### 環境構成
- **開発環境**: Docker Compose + ローカル開発
- **ステージング環境**: Railway + Vercel
- **本番環境**: Railway + Vercel

### CI/CD
- GitHub Actionsによる自動テスト
- 自動デプロイ（開発・ステージング）
- 手動デプロイ（本番環境）

### 監視・ログ
- 構造化ログ（structlog）
- エラートラッキング
- パフォーマンス監視
- セキュリティ監査
