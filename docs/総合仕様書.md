## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

Bridge LINEã¯ã€BtoBå‘ã‘ãƒãƒ¼ãƒ ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚ãƒãƒ¼ãƒ å˜ä½ã§ã®éŸ³å£°ãƒãƒ£ãƒƒãƒˆã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ–‡å­—èµ·ã“ã—ã€AIåˆ†æã«ã‚ˆã‚‹å€‹äººç‰¹æ€§ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’æä¾›ã—ã€ãƒãƒ¼ãƒ è²¬ä»»è€…ã«ã‚ˆã‚‹ä¸€å…ƒçš„ãªç®¡ç†ãƒ»æ±ºæ¸ˆæ©Ÿèƒ½ã‚’å‚™ãˆã¦ã„ã¾ã™ã€‚

---

### ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ç‰¹å¾´

- **BtoBç‰¹åŒ–**: ä¼æ¥­ãƒ»çµ„ç¹”ã®ãƒãƒ¼ãƒ å˜ä½ã§ã®å°å…¥ã‚’æƒ³å®š
- **éŸ³å£°ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³**: éŸ³å£°ã®ã¿ã§ã®ãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½ã«ç‰¹åŒ–
- **AIåˆ†æãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯**: è©±è€…åˆ¥ã®ç™ºè¨€ç‰¹æ€§ã‚’åˆ†æã—ã€å€‹äººã®æˆé•·ã‚’ã‚µãƒãƒ¼ãƒˆ
- **ãƒãƒ¼ãƒ è²¬ä»»è€…ç®¡ç†**: è²¬ä»»è€…ã«ã‚ˆã‚‹æ±ºæ¸ˆãƒ»ãƒ¡ãƒ³ãƒãƒ¼ç®¡ç†ã®ä¸€å…ƒåŒ–

## é–‹ç™ºä½“åˆ¶ãƒ»åˆ¶ç´„

- **é–‹ç™ºãƒãƒ¼ãƒ **: 3äººï¼ˆå…¨å“¡åˆå­¦è€…ï¼‰
- **é–‹ç™ºæœŸé–“**: 70æ™‚é–“ï¼ˆ5æ™‚é–“/æ—¥ Ã— 14æ—¥ï¼‰
- **æŠ€è¡“ç¿’å¾—**: å®Ÿè£…ã¨ä¸¦è¡Œã—ã¦å­¦ç¿’
- **é–‹ç™ºã‚´ãƒ¼ãƒ«**: æœ¬ç•ªç’°å¢ƒã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†
- **å“è³ªä¿è¨¼**: ãƒ•ãƒ­ãƒ³ãƒˆ/ãƒãƒƒã‚¯/E2Eãƒ†ã‚¹ãƒˆå¿…é ˆå®Ÿæ–½

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰

- **ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯**: Next.js 14.2.3 (App Router)
- **è¨€èª**: TypeScript 5.4.3
- **UIãƒ©ã‚¤ãƒ–ãƒ©ãƒª**: Material-UI (MUI) v5.15.15 + Radix UI + Tailwind CSS
- **çŠ¶æ…‹ç®¡ç†**: Zustand + React Hook Form
- **èªè¨¼**: Firebase Authentication
- **æ±ºæ¸ˆ**: Stripe v15.8.0
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡**: WebSocket (å®Ÿè£…æ¸ˆã¿)
- **éŸ³å£°å‡¦ç†**: WebRTC + ã‚«ã‚¹ã‚¿ãƒ éŸ³å£°å‡¦ç†ãƒ•ãƒƒã‚¯
- **ãƒ•ã‚©ãƒ¼ãƒ **: React Hook Form + Zod ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰

- **ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯**: FastAPI 0.110.1
- **è¨€èª**: Python 3.11+
- **ORM**: SQLAlchemy 2.0.29
- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**: PostgreSQL 15 + Alembic ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
- **èªè¨¼**: Firebase Admin SDK 6.5.0
- **æ±ºæ¸ˆ**: Stripe Python SDK 8.11.0
- **éŸ³å£°å‡¦ç†**: OpenAI Whisper API, librosa, numpy, scipy
- **AIåˆ†æ**: OpenAI GPT-4o API 1.14.3
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡**: WebSocket (websockets 12.0)
- **ãƒ­ã‚°**: structlog 24.1.0
- **ã‚­ãƒ£ãƒƒã‚·ãƒ¥**: Redis 5.0.3

### ã‚¤ãƒ³ãƒ•ãƒ©ãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ

- **ã‚³ãƒ³ãƒ†ãƒŠ**: Docker + Docker Compose
- **ã‚¯ãƒ©ã‚¦ãƒ‰**: Vercel (ãƒ•ãƒ­ãƒ³ãƒˆ) + Railway (ãƒãƒƒã‚¯ + DB)
- **CI/CD**: GitHub Actions
- **ç›£è¦–**: åŸºæœ¬ãƒ­ã‚° + ã‚¨ãƒ©ãƒ¼ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°
- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**: HTTPS, CORS, ç’°å¢ƒå¤‰æ•°ç®¡ç†

## ãƒšãƒ¼ã‚¸é·ç§»ãƒ»ç”»é¢æ§‹æˆ

```
Firebaseèªè¨¼ãƒ­ã‚°ã‚¤ãƒ³
ã€€â†“
ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
ã€€â”œâ”€â”€ éŸ³å£°ãƒãƒ£ãƒƒãƒˆãƒ«ãƒ¼ãƒ 
ã€€â”‚   â”œâ”€â”€ ãƒ­ã‚°ã‚¤ãƒ³ä¸­ãƒ¡ãƒ³ãƒãƒ¼è¡¨ç¤º
ã€€â”‚   â”œâ”€â”€ éŸ³å£°ãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½
ã€€â”‚   â””â”€â”€ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ–‡å­—èµ·ã“ã—è¡¨ç¤º
ã€€â”œâ”€â”€ ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼ç®¡ç†ï¼ˆè²¬ä»»è€…ã®ã¿ï¼‰
ã€€â”‚   â”œâ”€â”€ ãƒ¡ãƒ³ãƒãƒ¼ä¸€è¦§ãƒ»æ‹›å¾…
ã€€â”‚   â”œâ”€â”€ å„ãƒ¡ãƒ³ãƒãƒ¼ã®ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è©³ç´°
ã€€â”‚   â””â”€â”€ ãƒ¡ãƒ³ãƒãƒ¼æ¨©é™ç®¡ç†
ã€€â”œâ”€â”€ ãƒã‚¤ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«
ã€€â”‚   â”œâ”€â”€ ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†
ã€€â”‚   â””â”€â”€ AIåˆ†æãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ä¸€è¦§
ã€€â””â”€â”€ ãƒãƒ¼ãƒ ç®¡ç†ï¼ˆè²¬ä»»è€…ã®ã¿ï¼‰
ã€€ã€€ã€€â”œâ”€â”€ æ±ºæ¸ˆãƒ»ãƒ—ãƒ©ãƒ³ç®¡ç†
ã€€ã€€ã€€â”œâ”€â”€ ä½¿ç”¨é‡ç¢ºèª
ã€€ã€€ã€€â””â”€â”€ ãƒãƒ¼ãƒ è¨­å®š

```

## ã‚³ã‚¢æ©Ÿèƒ½

| æ©Ÿèƒ½å | èª¬æ˜ | å¯¾è±¡ãƒ¦ãƒ¼ã‚¶ãƒ¼ | å®Ÿè£…çŠ¶æ³ |
| --- | --- | --- | --- |
| ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ | Firebase Authentication + ãƒ­ãƒ¼ãƒ«ç®¡ç† | å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ | âœ… å®Ÿè£…æ¸ˆã¿ |
| éŸ³å£°ãƒãƒ£ãƒƒãƒˆãƒ«ãƒ¼ãƒ  | WebRTCéŸ³å£°é€šè©±ãƒ»ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ–‡å­—èµ·ã“ã— | å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ | âœ… å®Ÿè£…æ¸ˆã¿ |
| AIåˆ†æãƒ»ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ | ç™ºè¨€ç‰¹æ€§åˆ†æãƒ»å€‹äººç‰¹æ€§ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ | å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ | ğŸ”„ éƒ¨åˆ†å®Ÿè£… |
| ãƒãƒ¼ãƒ ç®¡ç† | ãƒ¡ãƒ³ãƒãƒ¼æ‹›å¾…ãƒ»æ¨©é™ç®¡ç† | è²¬ä»»è€…ã®ã¿ | âœ… å®Ÿè£…æ¸ˆã¿ |
| æ±ºæ¸ˆãƒ»ãƒ—ãƒ©ãƒ³ç®¡ç† | Stripeã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³æ±ºæ¸ˆ | è²¬ä»»è€…ã®ã¿ | ğŸ”„ éƒ¨åˆ†å®Ÿè£… |
| ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç®¡ç† | å€‹äººæƒ…å ±ãƒ»AIåˆ†æçµæœé–²è¦§ | å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ | âœ… å®Ÿè£…æ¸ˆã¿ |
| ç®¡ç†è€…æ©Ÿèƒ½ | ç®¡ç†è€…å°‚ç”¨ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç† | ç®¡ç†è€…ã®ã¿ | âœ… å®Ÿè£…æ¸ˆã¿ |
| å‚åŠ è€…ç®¡ç† | éŸ³å£°ã‚»ãƒƒã‚·ãƒ§ãƒ³å‚åŠ è€…ç®¡ç†ãƒ»æ¨©é™åˆ¶å¾¡ | ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†è€… | âœ… å®Ÿè£…æ¸ˆã¿ |
| éŸ³å£°å“è³ªå‘ä¸Š | AIéŸ³å£°å‡¦ç†ãƒ»ãƒã‚¤ã‚ºé™¤å» | å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ | ğŸ”„ éƒ¨åˆ†å®Ÿè£… |
| WebSocketé€šä¿¡ | ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ³ã‚°ãƒ»é€šçŸ¥ | å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ | âœ… å®Ÿè£…æ¸ˆã¿ |

## å®Ÿè£…æ¸ˆã¿æ©Ÿèƒ½è©³ç´°

### èªè¨¼ãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†
- Firebase Authenticationé€£æº
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ãƒ¼ãƒ«ç®¡ç†ï¼ˆowner, admin, memberï¼‰
- ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç®¡ç†ãƒ»ç·¨é›†æ©Ÿèƒ½

### éŸ³å£°ãƒãƒ£ãƒƒãƒˆãƒ»ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†
- WebSocketãƒ™ãƒ¼ã‚¹ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡
- éŸ³å£°ã‚»ãƒƒã‚·ãƒ§ãƒ³ä½œæˆãƒ»å‚åŠ ãƒ»ç®¡ç†
- å‚åŠ è€…æ¨©é™ç®¡ç†ãƒ»åˆ¶å¾¡
- ã‚»ãƒƒã‚·ãƒ§ãƒ³çŠ¶æ…‹ç®¡ç†

### ãƒãƒ¼ãƒ ãƒ»çµ„ç¹”ç®¡ç†
- ãƒãƒ¼ãƒ ä½œæˆãƒ»è¨­å®šãƒ»ç®¡ç†
- ãƒ¡ãƒ³ãƒãƒ¼æ‹›å¾…ãƒ»æ¨©é™è¨­å®š
- ãƒãƒ¼ãƒ å‚åŠ è€…ç®¡ç†

### ç®¡ç†è€…æ©Ÿèƒ½
- ç®¡ç†è€…å°‚ç”¨ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ãƒ»ç®¡ç†
- æ±ºæ¸ˆçŠ¶æ³ç¢ºèª
- ã‚·ã‚¹ãƒ†ãƒ çµ±è¨ˆæƒ…å ±

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ»ã‚¤ãƒ³ãƒ•ãƒ©
- PostgreSQL + SQLAlchemy ORM
- Alembic ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç®¡ç†
- Redis ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ»ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†
- Docker + Docker Compose ç’°å¢ƒ

## ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ

### ERå›³

```mermaid
erDiagram
    users {
        UUID id PK
        VARCHAR firebase_uid UK
        VARCHAR email UK
        VARCHAR display_name
        VARCHAR avatar_url
        BOOLEAN is_online
        TIMESTAMP last_seen_at
        VARCHAR account_status
        TIMESTAMP created_at
        TIMESTAMP updated_at
    }

    teams {
        UUID id PK
        VARCHAR name
        TEXT description
        VARCHAR team_code UK
        UUID created_by FK "è²¬ä»»è€…"
        INTEGER max_members
        BOOLEAN is_active
        JSONB settings
        TIMESTAMP created_at
        TIMESTAMP updated_at
    }

    team_memberships {
        UUID id PK
        UUID team_id FK
        UUID user_id FK
        VARCHAR role "owner/admin/member"
        VARCHAR status "active/inactive/invited"
        TIMESTAMP joined_at
        TIMESTAMP left_at
    }

    user_profiles {
        UUID id PK
        UUID user_id FK
        TEXT bio
        VARCHAR department
        VARCHAR position
        JSONB interests
        VARCHAR communication_style
        DECIMAL collaboration_score
        DECIMAL leadership_score
        DECIMAL empathy_score
        DECIMAL assertiveness_score
        DECIMAL creativity_score
        DECIMAL analytical_score
        JSONB visibility_settings
        INTEGER total_chat_sessions
        INTEGER total_speaking_time_seconds
        TIMESTAMP last_analysis_at
        TIMESTAMP created_at
        TIMESTAMP updated_at
    }

    voice_chat_sessions {
        UUID id PK
        UUID team_id FK
        VARCHAR title
        TEXT description
        VARCHAR status "waiting/active/ended/cancelled"
        INTEGER max_participants
        UUID started_by FK
        TIMESTAMP started_at
        TIMESTAMP ended_at
        INTEGER duration_seconds
        BOOLEAN auto_transcription
        INTEGER total_messages
        INTEGER total_speaking_time_seconds
        TIMESTAMP created_at
        TIMESTAMP updated_at
    }

    voice_messages {
        UUID id PK
        UUID session_id FK
        UUID speaker_id FK
        TEXT transcribed_text
        DECIMAL confidence_score
        DECIMAL audio_duration_seconds
        INTEGER session_timestamp_start
        INTEGER session_timestamp_end
        VARCHAR transcription_method
        VARCHAR message_type
        VARCHAR detected_emotion
        TIMESTAMP created_at
    }

    speaker_analyses {
        UUID id PK
        UUID session_id FK
        UUID speaker_id FK
        VARCHAR analysis_type
        INTEGER analyzed_message_count
        INTEGER analyzed_speaking_time_seconds
        DECIMAL participation_level
        DECIMAL speaking_ratio
        DECIMAL empathy_expression
        DECIMAL collaboration_facilitation
        DECIMAL logical_structure
        DECIMAL creative_ideas
        JSONB communication_strengths
        JSONB improvement_areas
        VARCHAR analysis_model
        DECIMAL confidence_level
        TIMESTAMP created_at
    }

    feedback_messages {
        UUID id PK
        UUID recipient_id FK
        UUID analysis_id FK
        UUID session_id FK
        VARCHAR feedback_type
        VARCHAR title
        TEXT summary
        TEXT detailed_content
        VARCHAR primary_category
        VARCHAR priority_level
        JSONB highlighted_strengths
        JSONB improvement_suggestions
        VARCHAR delivery_status
        BOOLEAN is_favorite
        INTEGER user_rating
        TIMESTAMP created_at
    }

    subscription_plans {
        UUID id PK
        VARCHAR name "free/premium/enterprise"
        VARCHAR display_name
        TEXT description
        DECIMAL price_monthly
        DECIMAL price_yearly
        INTEGER max_team_members
        INTEGER max_monthly_sessions
        INTEGER ai_analysis_limit
        JSONB features
        VARCHAR stripe_price_id_monthly
        VARCHAR stripe_price_id_yearly
        BOOLEAN is_active
        TIMESTAMP created_at
    }

    team_subscriptions {
        UUID id PK
        UUID team_id FK
        UUID plan_id FK
        UUID subscribed_by FK "è²¬ä»»è€…"
        VARCHAR stripe_customer_id
        VARCHAR stripe_subscription_id
        VARCHAR status "active/canceled/past_due"
        VARCHAR billing_cycle "monthly/yearly"
        TIMESTAMP current_period_start
        TIMESTAMP current_period_end
        BOOLEAN cancel_at_period_end
        TIMESTAMP created_at
        TIMESTAMP updated_at
    }

    payment_transactions {
        UUID id PK
        UUID team_id FK
        UUID subscription_id FK
        VARCHAR stripe_payment_intent_id
        DECIMAL amount
        VARCHAR currency
        VARCHAR status
        VARCHAR transaction_type
        TEXT description
        TIMESTAMP processed_at
        TIMESTAMP created_at
    }

    usage_tracking {
        UUID id PK
        UUID team_id FK
        DATE tracking_month
        INTEGER sessions_count
        INTEGER ai_analyses_count
        INTEGER total_speaking_time_seconds
        TIMESTAMP created_at
        TIMESTAMP updated_at
    }

    %% ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚·ãƒƒãƒ—
    users ||--o{ teams : "created_by(è²¬ä»»è€…)"
    users ||--o{ team_memberships : "user_id"
    teams ||--o{ team_memberships : "team_id"
    users ||--|| user_profiles : "user_id"
    teams ||--o{ voice_chat_sessions : "team_id"
    users ||--o{ voice_chat_sessions : "started_by"
    voice_chat_sessions ||--o{ voice_messages : "session_id"
    users ||--o{ voice_messages : "speaker_id"
    voice_chat_sessions ||--o{ speaker_analyses : "session_id"
    users ||--o{ speaker_analyses : "speaker_id"
    users ||--o{ feedback_messages : "recipient_id"
    speaker_analyses ||--o{ feedback_messages : "analysis_id"
    teams ||--|| team_subscriptions : "team_id"
    users ||--o{ team_subscriptions : "subscribed_by(è²¬ä»»è€…)"
    subscription_plans ||--o{ team_subscriptions : "plan_id"
    team_subscriptions ||--o{ payment_transactions : "subscription_id"
    teams ||--o{ usage_tracking : "team_id"

```

### ä¸»è¦ãƒ†ãƒ¼ãƒ–ãƒ«èª¬æ˜

### 1. ãƒãƒ¼ãƒ ãƒ»æ¨©é™ç®¡ç†

- **teams**: ãƒãƒ¼ãƒ åŸºæœ¬æƒ…å ±ï¼ˆè²¬ä»»è€…ãŒä½œæˆãƒ»ç®¡ç†ï¼‰
- **team_memberships**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ãƒãƒ¼ãƒ ã®é–¢ä¿‚ï¼ˆrole: owner/admin/memberï¼‰
- **users**: ãƒ¦ãƒ¼ã‚¶ãƒ¼åŸºæœ¬æƒ…å ±ï¼ˆFirebaseèªè¨¼é€£æºï¼‰

### 2. éŸ³å£°ãƒãƒ£ãƒƒãƒˆãƒ»åˆ†æ

- **voice_chat_sessions**: éŸ³å£°ãƒãƒ£ãƒƒãƒˆã‚»ãƒƒã‚·ãƒ§ãƒ³
- **voice_messages**: è©±è€…åˆ¥éŸ³å£°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ»æ–‡å­—èµ·ã“ã—
- **speaker_analyses**: AIåˆ†æçµæœ
- **feedback_messages**: å€‹äººç‰¹æ€§ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯

### 3. æ±ºæ¸ˆãƒ»ä½¿ç”¨é‡ç®¡ç†

- **subscription_plans**: ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³
- **team_subscriptions**: ãƒãƒ¼ãƒ å˜ä½ã®ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³
- **payment_transactions**: æ±ºæ¸ˆå±¥æ­´
- **usage_tracking**: æœˆåˆ¥ä½¿ç”¨é‡è¿½è·¡

## APIè¨­è¨ˆ

### èªè¨¼ãƒ»æ¨©é™ç®¡ç†

### POST /auth/login

Firebase IDãƒˆãƒ¼ã‚¯ãƒ³ã§ãƒ­ã‚°ã‚¤ãƒ³ãƒ»ãƒ­ãƒ¼ãƒ«æƒ…å ±å–å¾—

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**:

```json
{
  "firebase_id_token": "eyJhbGciOiJSUzI1NiIsInR5cCI...",
  "device_info": {
    "platform": "web",
    "browser": "Chrome"
  }
}

```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹**:

```json
{
  "success": true,
  "data": {
    "user": {
      "id": "user123",
      "firebase_uid": "firebase_123",
      "email": "admin@company.com",
      "display_name": "ç”°ä¸­å¤ªéƒ",
      "avatar_url": "<https://example.com/avatar.jpg>"
    },
    "team_roles": [
      {
        "team_id": "team123",
        "team_name": "é–‹ç™ºãƒãƒ¼ãƒ ",
        "role": "owner"
      }
    ],
    "session_token": "session_token_123"
  }
}

```

### ãƒãƒ¼ãƒ ç®¡ç†ï¼ˆè²¬ä»»è€…ã®ã¿ï¼‰

### GET /teams/{team_id}/members

ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼ä¸€è¦§å–å¾—

**èªå¯**: ãƒãƒ¼ãƒ è²¬ä»»è€…ãƒ»ç®¡ç†è€…ã®ã¿

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹**:

```json
{
  "success": true,
  "data": {
    "team": {
      "id": "team123",
      "name": "é–‹ç™ºãƒãƒ¼ãƒ ",
      "member_count": 8,
      "subscription_plan": "premium",
      "usage_this_month": {
        "sessions_count": 15,
        "ai_analyses_count": 120,
        "limit_sessions": 50,
        "limit_analyses": 500
      }
    },
    "members": [
      {
        "id": "user123",
        "display_name": "ç”°ä¸­å¤ªéƒ",
        "email": "tanaka@company.com",
        "role": "owner",
        "status": "active",
        "joined_at": "2024-01-01T00:00:00Z",
        "last_active": "2024-01-15T10:30:00Z"
      }
    ]
  }
}

```

### POST /teams/{team_id}/invite

ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼æ‹›å¾…

**èªå¯**: ãƒãƒ¼ãƒ è²¬ä»»è€…ãƒ»ç®¡ç†è€…ã®ã¿

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**:

```json
{
  "email": "new_member@company.com",
  "role": "member",
  "display_name": "å±±ç”°èŠ±å­"
}

```

### æ±ºæ¸ˆç®¡ç†ï¼ˆè²¬ä»»è€…ã®ã¿ï¼‰

### GET /teams/{team_id}/subscription

ãƒãƒ¼ãƒ ã®ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³æƒ…å ±å–å¾—

**èªå¯**: ãƒãƒ¼ãƒ è²¬ä»»è€…ã®ã¿

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹**:

```json
{
  "success": true,
  "data": {
    "subscription": {
      "id": "sub123",
      "plan": {
        "name": "premium",
        "display_name": "ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ—ãƒ©ãƒ³",
        "price_monthly": 980,
        "max_team_members": 10,
        "max_monthly_sessions": 50,
        "ai_analysis_limit": 500,
        "features": ["é«˜åº¦AIåˆ†æ", "è©³ç´°ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯", "ãƒãƒ¼ãƒ åˆ†æãƒ¬ãƒãƒ¼ãƒˆ"]
      },
      "status": "active",
      "billing_cycle": "monthly",
      "current_period_start": "2024-01-01T00:00:00Z",
      "current_period_end": "2024-02-01T00:00:00Z",
      "cancel_at_period_end": false
    },
    "usage_current_month": {
      "sessions_count": 15,
      "ai_analyses_count": 120,
      "total_speaking_time_hours": 25.5
    },
    "next_payment": {
      "amount": 980,
      "currency": "JPY",
      "due_date": "2024-02-01T00:00:00Z"
    }
  }
}

```

### POST /teams/{team_id}/subscribe

æ–°è¦ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³é–‹å§‹

**èªå¯**: ãƒãƒ¼ãƒ è²¬ä»»è€…ã®ã¿

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**:

```json
{
  "plan_id": "plan123",
  "billing_cycle": "monthly",
  "payment_method": "stripe"
}

```

### GET /subscription/plans

åˆ©ç”¨å¯èƒ½ãªã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³ä¸€è¦§

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹**:

```json
{
  "success": true,
  "data": {
    "plans": [
      {
        "id": "plan1",
        "name": "free",
        "display_name": "ãƒ•ãƒªãƒ¼ãƒ—ãƒ©ãƒ³",
        "description": "åŸºæœ¬æ©Ÿèƒ½ã‚’ç„¡æ–™ã§åˆ©ç”¨",
        "price_monthly": 0,
        "price_yearly": 0,
        "max_team_members": 3,
        "max_monthly_sessions": 5,
        "ai_analysis_limit": 20,
        "features": ["åŸºæœ¬éŸ³å£°ãƒãƒ£ãƒƒãƒˆ", "ç°¡æ˜“åˆ†æãƒ¬ãƒãƒ¼ãƒˆ"],
        "is_popular": false
      },
      {
        "id": "plan2",
        "name": "premium",
        "display_name": "ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ—ãƒ©ãƒ³",
        "description": "ãƒãƒ¼ãƒ åˆ©ç”¨ã«æœ€é©",
        "price_monthly": 980,
        "price_yearly": 9800,
        "max_team_members": 10,
        "max_monthly_sessions": 50,
        "ai_analysis_limit": 500,
        "features": ["é«˜åº¦AIåˆ†æ", "è©³ç´°ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯", "ãƒãƒ¼ãƒ åˆ†æãƒ¬ãƒãƒ¼ãƒˆ", "ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ"],
        "is_popular": true
      },
      {
        "id": "plan3",
        "name": "enterprise",
        "display_name": "ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºãƒ—ãƒ©ãƒ³",
        "description": "å¤§è¦æ¨¡ãƒãƒ¼ãƒ å‘ã‘",
        "price_monthly": 2980,
        "price_yearly": 29800,
        "max_team_members": 50,
        "max_monthly_sessions": 200,
        "ai_analysis_limit": 2000,
        "features": ["ç„¡åˆ¶é™AIåˆ†æ", "ã‚«ã‚¹ã‚¿ãƒ åˆ†æ", "API ã‚¢ã‚¯ã‚»ã‚¹", "å°‚ç”¨ã‚µãƒãƒ¼ãƒˆ"],
        "is_popular": false
      }
    ]
  }
}

```

### éŸ³å£°ãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½

### POST /teams/{team_id}/voice-sessions

éŸ³å£°ãƒãƒ£ãƒƒãƒˆã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**:

```json
{
  "title": "é€±æ¬¡å®šä¾‹ãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°",
  "description": "ä»Šé€±ã®é€²æ—ã¨æ¥é€±ã®è¨ˆç”»ã«ã¤ã„ã¦",
  "max_participants": 8,
  "auto_transcription": true
}

```

### POST /voice-sessions/{session_id}/messages

éŸ³å£°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡ãƒ»æ–‡å­—èµ·ã“ã—

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ** (multipart/form-data):

```
audio_file: (file) éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«
session_timestamp_start: (integer) é–‹å§‹ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ï¼ˆãƒŸãƒªç§’ï¼‰
session_timestamp_end: (integer) çµ‚äº†ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ï¼ˆãƒŸãƒªç§’ï¼‰

```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹**:

```json
{
  "success": true,
  "data": {
    "message": {
      "id": "message123",
      "session_id": "session123",
      "speaker": {
        "id": "user123",
        "display_name": "ç”°ä¸­å¤ªéƒ"
      },
      "transcribed_text": "ä»Šé€±ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé€²æ—ã«ã¤ã„ã¦å ±å‘Šã—ã¾ã™ã€‚ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®å®Ÿè£…ãŒé †èª¿ã«é€²ã‚“ã§ã„ã¾ã™ã€‚",
      "confidence_score": 0.9240,
      "audio_duration_seconds": 8.5,
      "detected_emotion": "neutral",
      "created_at": "2024-01-15T10:02:00Z"
    }
  }
}

```

### AIåˆ†æãƒ»ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯

### POST /voice-sessions/{session_id}/analyze

ã‚»ãƒƒã‚·ãƒ§ãƒ³çµ‚äº†å¾Œã®AIåˆ†æå®Ÿè¡Œ

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**:

```json
{
  "analysis_type": "comprehensive",
  "generate_feedback": true,
  "update_user_profiles": true
}

```

### GET /profile/me/feedback

è‡ªåˆ†ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ä¸€è¦§å–å¾—

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹**:

```json
{
  "success": true,
  "data": {
    "feedback": [
      {
        "id": "feedback123",
        "title": "ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ç‰¹æ€§åˆ†æçµæœ",
        "summary": "å”èª¿æ€§ãŒé«˜ãã€ãƒãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’é‡è¦–ã—ãŸã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ã‚¿ã‚¤ãƒ«ã§ã™",
        "primary_category": "communication",
        "priority_level": "high",
        "delivery_status": "delivered",
        "is_favorite": false,
        "created_at": "2024-01-15T10:30:00Z",
        "source_session": {
          "id": "session123",
          "title": "é€±æ¬¡å®šä¾‹ãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°",
          "date": "2024-01-15T10:00:00Z"
        }
      }
    ],
    "summary": {
      "total_count": 12,
      "unread_count": 3,
      "high_priority_count": 1
    }
  }
}

```

## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä»•æ§˜

### èªè¨¼ãƒ»èªå¯

- **Firebase Authentication**: ãƒ¡ãƒ¼ãƒ«/ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰èªè¨¼
- **JWT Token**: APIã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
- **Role-Based Access Control**: owner/admin/memberæ¨©é™ç®¡ç†
- **Team-Based Authorization**: ãƒãƒ¼ãƒ å˜ä½ã§ã®ãƒªã‚½ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡

### ãƒ‡ãƒ¼ã‚¿ä¿è­·

- **HTTPSé€šä¿¡**: å…¨é€šä¿¡ã®æš—å·åŒ–
- **å€‹äººæƒ…å ±æš—å·åŒ–**: æ©Ÿå¯†ãƒ‡ãƒ¼ã‚¿ã®DBæš—å·åŒ–ä¿å­˜
- **éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«**: ä¸€æ™‚ä¿å­˜ãƒ»å‡¦ç†å¾Œè‡ªå‹•å‰Šé™¤
- **CORSè¨­å®š**: è¨±å¯ãƒ‰ãƒ¡ã‚¤ãƒ³ã®ã¿APIã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½

### æ±ºæ¸ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

- **PCI DSSæº–æ‹ **: Stripeæ±ºæ¸ˆã«ã‚ˆã‚‹å®‰å…¨ãªæ±ºæ¸ˆå‡¦ç†
- **Webhookç½²åæ¤œè¨¼**: Stripe Webhookã®æ­£å½“æ€§æ¤œè¨¼
- **API Keyç®¡ç†**: ç’°å¢ƒå¤‰æ•°ã«ã‚ˆã‚‹æ©Ÿå¯†æƒ…å ±ç®¡ç†

### å…¥åŠ›æ¤œè¨¼ãƒ»ã‚µãƒ‹ã‚¿ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³

- **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰**: Pydantic ã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼
- **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰**: TypeScriptå‹ãƒã‚§ãƒƒã‚¯ + ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
- **SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³å¯¾ç­–**: SQLAlchemy ORMä½¿ç”¨
- **XSSå¯¾ç­–**: å…¥åŠ›å€¤ã‚µãƒ‹ã‚¿ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³

## ãƒ†ã‚¹ãƒˆä»•æ§˜

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ

```tsx
// ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
- Jest + React Testing Library
- MSW (Mock Service Worker) - API ãƒ¢ãƒƒã‚¯
- Cypress - E2Eãƒ†ã‚¹ãƒˆ

// ãƒ†ã‚¹ãƒˆå¯¾è±¡
- ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ
- ãƒ•ãƒƒã‚¯ãƒ†ã‚¹ãƒˆ
- çµ±åˆãƒ†ã‚¹ãƒˆï¼ˆAPIé€£æºï¼‰
- E2Eãƒ†ã‚¹ãƒˆï¼ˆä¸»è¦ãƒ•ãƒ­ãƒ¼ï¼‰

```

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ

```python
# ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
- pytest
- pytest-asyncio
- httpx (ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ)
- pytest-mock

# ãƒ†ã‚¹ãƒˆå¯¾è±¡
- APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãƒ†ã‚¹ãƒˆ
- ã‚µãƒ¼ãƒ“ã‚¹å±¤ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±åˆãƒ†ã‚¹ãƒˆ
- å¤–éƒ¨APIé€£æºãƒ†ã‚¹ãƒˆï¼ˆãƒ¢ãƒƒã‚¯ä½¿ç”¨ï¼‰

```

### E2Eãƒ†ã‚¹ãƒˆ

```tsx
// Cypressã‚’ä½¿ç”¨ã—ãŸE2Eãƒ†ã‚¹ãƒˆ
- ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ãƒ•ãƒ­ãƒ¼
- ãƒãƒ¼ãƒ ä½œæˆãƒ»ãƒ¡ãƒ³ãƒãƒ¼æ‹›å¾…
- éŸ³å£°ãƒãƒ£ãƒƒãƒˆã‚»ãƒƒã‚·ãƒ§ãƒ³ï¼ˆãƒ¢ãƒƒã‚¯éŸ³å£°ä½¿ç”¨ï¼‰
- æ±ºæ¸ˆãƒ•ãƒ­ãƒ¼ï¼ˆStripeãƒ†ã‚¹ãƒˆãƒ¢ãƒ¼ãƒ‰ï¼‰
- AIåˆ†æãƒ»ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ç¢ºèª

```

## CI/CDä»•æ§˜ï¼ˆGitHub Actionsï¼‰

### ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æ§‹æˆ

### .github/workflows/ci.yml

```yaml
name: CI/CD Pipeline

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

jobs:
  # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ
  frontend-test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: '18'
          cache: 'npm'
          cache-dependency-path: frontend/package-lock.json

      - name: Install dependencies
        run: cd frontend && npm ci

      - name: Run type check
        run: cd frontend && npm run type-check

      - name: Run unit tests
        run: cd frontend && npm run test -- --coverage

      - name: Run build
        run: cd frontend && npm run build

  # ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ
  backend-test:
    runs-on: ubuntu-latest
    services:
      postgres:
        image: postgres:15
        env:
          POSTGRES_PASSWORD: postgres
          POSTGRES_DB: bridge_line_test
        options: >-
          --health-cmd pg_isready
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
        ports:
          - 5432:5432

    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v4
        with:
          python-version: '3.11'

      - name: Install dependencies
        run: |
          cd backend
          pip install -r requirements.txt
          pip install pytest pytest-asyncio pytest-cov

      - name: Run tests
        env:
          DATABASE_URL: postgresql://postgres:postgres@localhost:5432/bridge_line_test
          OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY_TEST }}
          STRIPE_SECRET_KEY: ${{ secrets.STRIPE_SECRET_KEY_TEST }}
        run: cd backend && pytest --cov=app tests/

  # E2Eãƒ†ã‚¹ãƒˆ
  e2e-test:
    runs-on: ubuntu-latest
    needs: [frontend-test, backend-test]
    if: github.event_name == 'push' && github.ref == 'refs/heads/main'

    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: '18'

      - name: Install dependencies
        run: cd frontend && npm ci

      - name: Build application
        run: cd frontend && npm run build

      - name: Run E2E tests
        run: cd frontend && npm run cypress:run
        env:
          CYPRESS_BASE_URL: <http://localhost:3000>
          CYPRESS_API_URL: <http://localhost:8000>

  # ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆmainãƒ–ãƒ©ãƒ³ãƒã®ã¿ï¼‰
  deploy:
    runs-on: ubuntu-latest
    needs: [frontend-test, backend-test, e2e-test]
    if: github.ref == 'refs/heads/main'

    steps:
      - uses: actions/checkout@v4

      # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆVercelï¼‰
      - name: Deploy Frontend to Vercel
        uses: amondnet/vercel-action@v25
        with:
          vercel-token: ${{ secrets.VERCEL_TOKEN }}
          vercel-org-id: ${{ secrets.VERCEL_ORG_ID }}
          vercel-project-id: ${{ secrets.VERCEL_PROJECT_ID }}
          working-directory: ./frontend

      # ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆRailwayï¼‰
      - name: Deploy Backend to Railway
        uses: bervProject/railway-deploy@v1.0.0
        with:
          railway_token: ${{ secrets.RAILWAY_TOKEN }}
          service: ${{ secrets.RAILWAY_SERVICE_ID }}

```

### ãƒ‡ãƒ—ãƒ­ã‚¤ç’°å¢ƒ

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆVercelï¼‰

```bash
# ç’°å¢ƒå¤‰æ•°
NEXT_PUBLIC_API_URL=https://bridge-line-api.railway.app
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_live_...
NEXT_PUBLIC_FIREBASE_CONFIG={"apiKey":"..."}

```

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆRailwayï¼‰

```bash
# ç’°å¢ƒå¤‰æ•°
DATABASE_URL=postgresql://user:pass@host:port/db
OPENAI_API_KEY=sk-...
STRIPE_SECRET_KEY=sk_live_...
STRIPE_WEBHOOK_SECRET=whsec_...
FIREBASE_PROJECT_ID=bridge-line-prod
CORS_ORIGINS=["<https://bridge-line.vercel.app>"]

```

## é–‹ç™ºã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«

### Phase 1: èªè¨¼ãƒ»åŸºæœ¬æ©Ÿèƒ½ï¼ˆDay 1-4, 20æ™‚é–“ï¼‰

- Firebaseèªè¨¼å®Ÿè£…
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ»ãƒãƒ¼ãƒ ç®¡ç†
- åŸºæœ¬UIæ§‹ç¯‰
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### Phase 2: éŸ³å£°ãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½ï¼ˆDay 5-8, 20æ™‚é–“ï¼‰

- WebRTCéŸ³å£°é€šè©±å®Ÿè£…
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ–‡å­—èµ·ã“ã—
- ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†æ©Ÿèƒ½

### Phase 3: AIåˆ†æãƒ»ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ï¼ˆDay 9-11, 15æ™‚é–“ï¼‰

- OpenAI APIé€£æº
- åˆ†æçµæœä¿å­˜ãƒ»è¡¨ç¤º
- ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯æ©Ÿèƒ½

### Phase 4: æ±ºæ¸ˆãƒ»æ¨©é™ç®¡ç†ï¼ˆDay 12-13, 10æ™‚é–“ï¼‰

- Stripeæ±ºæ¸ˆæ©Ÿèƒ½
- è²¬ä»»è€…æ¨©é™ç®¡ç†
- ä½¿ç”¨é‡åˆ¶é™æ©Ÿèƒ½

### Phase 5: ãƒ†ã‚¹ãƒˆãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆDay 14, 5æ™‚é–“ï¼‰

- å„ç¨®ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
- CI/CDè¨­å®š
- æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤

## é‹ç”¨ãƒ»ç›£è¦–

### ãƒ­ã‚°ç®¡ç†

- **ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚°**: æ§‹é€ åŒ–ãƒ­ã‚°å‡ºåŠ›
- **ã‚¨ãƒ©ãƒ¼ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°**: åŸºæœ¬çš„ãªã‚¨ãƒ©ãƒ¼ç›£è¦–
- **ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°**: APIå‘¼ã³å‡ºã—è¨˜éŒ²
- **æ±ºæ¸ˆãƒ­ã‚°**: Stripe Webhook ã‚¤ãƒ™ãƒ³ãƒˆè¨˜éŒ²

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–

- **ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“**: APIå¿œç­”é€Ÿåº¦ç›£è¦–
- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**: ã‚¯ã‚¨ãƒªãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡**: WebSocketæ¥ç¶šçŠ¶æ…‹
- **å¤–éƒ¨API**: OpenAIãƒ»Stripe APIå¿œç­”ç›£è¦–

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£è¦–

- **èªè¨¼å¤±æ•—**: ä¸æ­£ãƒ­ã‚°ã‚¤ãƒ³è©¦è¡Œæ¤œçŸ¥
- **APIåˆ©ç”¨é‡**: ãƒ¬ãƒ¼ãƒˆåˆ¶é™ãƒ»ç•°å¸¸ã‚¢ã‚¯ã‚»ã‚¹æ¤œçŸ¥
- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**: ç•°å¸¸ã‚¯ã‚¨ãƒªæ¤œçŸ¥

ã“ã®ä»•æ§˜æ›¸ã«åŸºã¥ãã€Bridge LINEã®é–‹ç™ºã‹ã‚‰æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤ã¾ã§ã‚’åŒ…æ‹¬çš„ã«å®Ÿè¡Œã§ãã¾ã™ã€‚åˆå­¦è€…ãƒãƒ¼ãƒ ã§ã‚‚æ®µéšçš„ã«å­¦ç¿’ã—ãªãŒã‚‰ã€ä¼æ¥­å‘ã‘ã®å …ç‰¢ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ§‹ç¯‰ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚